ShopOfMe.Routers.Items=Support.SwappingRouter.extend({initialize:function(e){this.el=$("#main_wrap"),this.collection=e.collection,this.filter=e.filter,this.current_view=null},routes:{"":"recommendations",history:"history",topitems:"topItems","items/:id":"showItem"},recommendations:function(){$(".menu_rec").spin({lines:8,length:4,width:3,radius:5,top:15,left:184,color:"gray"}),self=this,this.filter.set("category","-1");var e=new ShopOfMe.Views.ListingPage({items:this.collection,user:null,filters:this.filter,no_items_template:"recs"});ShopOfMe.currently_selected_items=ShopOfMe.source_items,window.initial_source_items?(ShopOfMe.source_items.add(window.initial_source_items),this.stopAllSpinners(),self.setActiveNav("rec_main_nav"),self.swap2(e),self.swap(e),window.initial_source_items=null):ShopOfMe.source_items.fetch({data:{identifier:ShopOfMe.user.get("identifier"),gender:ShopOfMe.filter.get("gender"),category:ShopOfMe.filter.get("category"),minPrice:ShopOfMe.filter.get("minPrice"),maxPrice:ShopOfMe.filter.get("maxPrice"),reset_page:!0},silent:!0,success:function(){self.stopAllSpinners(),self.setActiveNav("rec_main_nav"),ShopOfMe.source_items.add(),self.swap2(e),self.swap(e)}})},history:function(){$(".menu_history").spin({lines:8,length:4,width:3,radius:5,top:15,left:100,color:"gray"}),self=this,this.filter.softReset();var e=new ShopOfMe.Views.ListingPage({items:ShopOfMe.history_items,user:null,filters:this.filter,no_items_template:"history"});ShopOfMe.currently_selected_items=ShopOfMe.history_items,ShopOfMe.history_items.fetch({data:{identifier:ShopOfMe.user.get("identifier"),reset_page:!0},silent:!0,success:function(){self.stopAllSpinners(),self.setActiveNav("history_main_nav"),ShopOfMe.history_items.add(),self.swap2(e),self.swap(e)}})},topItems:function(){this.filter.set("category","-1"),this.setActiveNav("hot_main_nav");var e=new ShopOfMe.Views.ListingPage({items:ShopOfMe.top_items,user:null,filters:this.filter,no_items_template:"topitems"});this.swap2(e),this.swap(e)},showItem:function(e){the_item=new ShopOfMe.Models.Item({id:e});var t=new ShopOfMe.Views.ListingPage({model:the_item,user:null,filters:this.filter});this.swap(t)},setActiveNav:function(e){nav_options=["rec_main_nav","history_main_nav","hot_main_nav"],_.each(nav_options,function(t){t==e?$("#"+t).css("font-weight","bold"):$("#"+t).css("font-weight","normal")})},stopAllSpinners:function(){rec_spinner=$(".menu_rec").data().spinner,history_spinner=$(".menu_history").data().spinner,void 0!==rec_spinner&&rec_spinner.stop(),void 0!==history_spinner&&history_spinner.stop()},swap2:function(e){null!=this.current_view&&this.current_view.forceUnbind(),this.current_view=e}});